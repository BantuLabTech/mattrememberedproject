language: node_js
node_js:
- lts/*
addons:
  apt:
    packages:
    - libgconf-2-4
services: 
cache:
  npm: true
  directories:
  - "~/.cache"
  - "./node_modules"
  - "~/.cache"
override:
- npm ci
- npm run cy:verify
install:
- npm ci
- chmod +x node_modules/.bin/*
script:
- npm run build
deploy:
  skip_cleanup: true
  provider: heroku
  api_key:
  app: mattrememberedproject
  on:
    repo: BantuLabTech/mattrememberedproject
    branch: master
  after_failure:
  - find $HOME ! \( -type d \) -name node-dev -exec ls -lah {} \;
env:
  global:
  - TEST_URL_ENV=http://localhost:8080
